<?xml version="1.0" encoding="UTF-8" ?>
<testcase version="3" baseURL="http://localhost:8080" xmlns="http://xlt.xceptance.com/xlt-script/2">
  <description>Changes name, email address and password of a customer.</description>
  <module name="module.OpenHomepage"/>
  <module name="module.Login">
    <parameter name="email" value="${email}"/>
    <parameter name="password" value="${password}"/>
    <parameter name="firstName" value="${firstName}"/>
  </module>
  <action name="NavigateToPersonalData"/>
  <command name="click" target="//li[@id='dropdown']/a"/>
  <command name="clickAndWait" target="//*[@id='btnAccountOverview']/a"/>
  <command name="clickAndWait" target="id=linkPersonalData"/>
  <command name="assertElementPresent" target="id=titlePersonalData"/>
  <command name="assertText" target="id=customerName" value="regexp:.*${fullName}"/>
  <command name="assertText" target="id=customerEmail" value="regexp:.*${email}"/>
  <action name="ChangeNameAndEmail"/>
  <command name="clickAndWait" target="id=btnChangeNameEmail"/>
  <command name="assertElementPresent" target="id=formChangeNameEmail"/>
  <command name="assertText" target="id=name" value="${name}"/>
  <command name="assertText" target="id=firstName" value="${firstName}"/>
  <command name="assertText" target="id=eMail" value="${email}"/>
  <command name="type" target="id=name" value="name"/>
  <command name="store" target="firstName" value="newFirstName"/>
  <command name="type" target="id=firstName" value="${newFirstName}"/>
  <command name="store" target="john2@doe.com" value="newEmail"/>
  <command name="type" target="id=eMail" value="${newEmail}"/>
  <command name="type" target="id=password" value="${password}"/>
  <command name="clickAndWait" target="id=btnChangeNameEmail"/>
  <action name="VerifyNewData"/>
  <command name="assertElementPresent" target="id=successMessage"/>
  <command name="assertText" target="id=customerName" value="regexp:.*${newFirstName} name"/>
  <command name="assertText" target="id=customerEmail" value="regexp:.*${newEmail}"/>
  <command name="assertText" target="//li[@id='dropdown']/a" value="regexp:.*firstName"/>
  <action name="ChangePassword"/>
  <command name="clickAndWait" target="id=btnChangePassword"/>
  <command name="type" target="id=oldPassword" value="${password}"/>
  <command name="store" target="secret4ever" value="newPassword"/>
  <command name="type" target="id=password" value="${newPassword}"/>
  <command name="type" target="id=passwordAgain" value="${newPassword}"/>
  <command name="clickAndWait" target="id=btnChangePassword"/>
  <command name="assertElementPresent" target="id=successMessage"/>
  <module name="module.Logout"/>
  <action name="TryLoginWithOldPassword"/>
  <command name="clickAndWait" target="id=btnShowLoginForm"/>
  <command name="type" target="id=email" value="${newEmail}"/>
  <command name="type" target="id=password" value="${password}"/>
  <command name="clickAndWait" target="id=btnSignIn"/>
  <command name="assertElementPresent" target="id=errorMessage"/>
  <command name="assertElementPresent" target="id=btnShowLoginForm"/>
  <action name="ResetPassword"/>
  <module name="module.Login">
    <parameter name="email" value="${newEmail}"/>
    <parameter name="password" value="${newPassword}"/>
    <parameter name="firstName" value="${newFirstName}"/>
  </module>
  <command name="click" target="//li[@id='dropdown']/a"/>
  <command name="clickAndWait" target="//*[@id='btnAccountOverview']/a"/>
  <command name="clickAndWait" target="id=linkPersonalData"/>
  <command name="clickAndWait" target="id=btnChangePassword"/>
  <command name="type" target="id=oldPassword" value="${newPassword}"/>
  <command name="type" target="id=password" value="${password}"/>
  <command name="type" target="id=passwordAgain" value="${password}"/>
  <command name="clickAndWait" target="id=btnChangePassword"/>
  <action name="ResetNameAndEmail"/>
  <command name="clickAndWait" target="id=btnChangeNameEmail"/>
  <command name="type" target="id=name" value="${name}"/>
  <command name="type" target="id=firstName" value="${firstName}"/>
  <command name="type" target="id=eMail" value="${email}"/>
  <command name="type" target="id=password" value="${password}"/>
  <command name="clickAndWait" target="id=btnChangeNameEmail"/>
</testcase>
